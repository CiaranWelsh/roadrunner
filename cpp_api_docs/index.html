<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libRoadRunner C++ API: The LibRoadRunner C++ Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libRoadRunner C++ API
   &#160;<span id="projectnumber">1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The LibRoadRunner C++ Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Andy Somogyi (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'y.'+'som'+'og'+'yi@'+'gm'+'ail'+'.c'+'om'; return false;">andy.<span style="display: none;">.nosp@m.</span>somo<span style="display: none;">.nosp@m.</span>gyi@g<span style="display: none;">.nosp@m.</span>mail<span style="display: none;">.nosp@m.</span>.com</a>, <a href="#" onclick="location.href='mai'+'lto:'+'som'+'og'+'yie'+'@i'+'ndi'+'an'+'a.e'+'du'; return false;">somog<span style="display: none;">.nosp@m.</span>yie@<span style="display: none;">.nosp@m.</span>india<span style="display: none;">.nosp@m.</span>na.e<span style="display: none;">.nosp@m.</span>du</a>) </dd>
<dd>
Totte Karlsson (<a href="#" onclick="location.href='mai'+'lto:'+'tot'+'te'+'@du'+'ne'+'sci'+'en'+'tif'+'ic'+'.co'+'m'; return false;">totte<span style="display: none;">.nosp@m.</span>@dun<span style="display: none;">.nosp@m.</span>escie<span style="display: none;">.nosp@m.</span>ntif<span style="display: none;">.nosp@m.</span>ic.co<span style="display: none;">.nosp@m.</span>m</a>) </dd>
<dd>
Herbert M. Sauro (<a href="#" onclick="location.href='mai'+'lto:'+'hsa'+'ur'+'o@u'+'.w'+'ash'+'in'+'gto'+'n.'+'edu'; return false;">hsaur<span style="display: none;">.nosp@m.</span>o@u.<span style="display: none;">.nosp@m.</span>washi<span style="display: none;">.nosp@m.</span>ngto<span style="display: none;">.nosp@m.</span>n.edu</a>)</dd></dl>
<h1><a class="anchor" id="sec_intro"></a>
Introduction</h1>
<p>This document describes the application programming interface (API) of <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a>, an open source (BSD) library for computing structural characteristics of cellular networks.</p>
<h1><a class="anchor" id="sec_install"></a>
Instalation</h1>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt>Dependencies</dt><dd>The <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a> library depend on several third-party libraries, CLapack, libSBML (libxml2), Sundials, NLEQ, and Poco. These are provided with the binary installation where necessary. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section user"><dt></dt><dd>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</dd></dl>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
</ul>
<ul>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ul>
<ul>
<li>Neither the name of University of Washington nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<dl class="section user"><dt></dt><dd></dd></dl>
<h1><a class="anchor" id="sec_new_integrator"></a>
Creating a new Integrator</h1>
<p>One of the key design goals of the LibRoadRunner library is extensibility. This means that the library is designed with the idea that most internal components are loosely coupled and that it is simple to add new solvers such as new steady state solvers or integrators. This section will give a tutorial on creating a new integrator using the <a class="el" href="classrr_1_1_euler_integrator.html">EulerIntegrator</a> as an example.</p>
<p>At its simplest, an <a class="el" href="classrr_1_1_integrator.html">Integrator</a> is a class which implements the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> interface and is responsible for advanding a model (an object which implements the <a class="el" href="classrr_1_1_executable_model.html">ExecutableModel</a> interface) forward in time.</p>
<p>All Integrators are created by the <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> class, this is the only class that knows about the existence of any <a class="el" href="classrr_1_1_integrator.html">Integrator</a> objects. All integrators that the <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> knows about are automatically available to any code (including any Python code) that needs to create one. Each time the <a class="el" href="classrr_1_1_road_runner.html#a196e38611d37cd1a79bce8373ceb12da">RoadRunner::simulate</a> method is called, a different integrator may be specified. In Python, this is done with the <code>integrator</code> keyword, i.e.</p>
<div class="fragment"><div class="line">r.simulate(0, 10, 100, integrator=<span class="stringliteral">&quot;MyIntegratorName&quot;</span>)</div>
</div><!-- fragment --><p>Or, in C++:</p>
<div class="fragment"><div class="line">BasicDictionary d;</div>
<div class="line">d.setItem(<span class="stringliteral">&quot;integrator&quot;</span>, <span class="stringliteral">&quot;MyIntegratorName&quot;</span>)</div>
<div class="line">r.simulate(&amp;d);</div>
</div><!-- fragment --><p>To create a new integrator, one first needs to create an object that implments the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> interface, tell <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a> about it.</p>
<h2><a class="anchor" id="sec_int_impl"></a>
Implementing the Integrator interface</h2>
<p>The <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> is the ONLY object that creates integrators.</p>
<p>Integrators are created when the <a class="el" href="classrr_1_1_integrator_factory.html#ae43f5cd23488a69528785bf97db603b8">IntegratorFactory::New</a> method is called, typically by the top level <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a> object. New Integrators are given a pointer to an existing <a class="el" href="classrr_1_1_executable_model.html">ExecutableModel</a> object which the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> is responsible for advancing forward in time, and pointer to a <a class="el" href="classrr_1_1_simulate_options.html">SimulateOptions</a> object which contains the initial set of parameters that the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> may configure itself with.</p>
<p>The integrator will hold onto the <a class="el" href="classrr_1_1_executable_model.html">ExecutableModel</a> pointer, m, and when the <a class="el" href="classrr_1_1_integrator.html#aa29aac9228f7834cfb92d04f823e5ddf">Integrator::integrate</a> method is called, will advance the model object forward in time.</p>
<p>There are three key members of the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> interface that an integrator needs be implement:</p>
<ul>
<li><a class="el" href="classrr_1_1_integrator.html#ac1fa1ad5df380215b40bb1ab268621fa">Integrator::setSimulateOptions</a> This method is called whenever the simulation parameters are changed via calls to the <a class="el" href="classrr_1_1_road_runner.html#a196e38611d37cd1a79bce8373ceb12da">RoadRunner::simulate</a> method, the setSimulateOptions method is called by <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a> object to inform the <a class="el" href="classrr_1_1_integrator.html">Integrator</a> of any new parameter changes. This method should be used to read any updated tuning parameters.</li>
</ul>
<ul>
<li><a class="el" href="classrr_1_1_integrator.html#aa29aac9228f7834cfb92d04f823e5ddf">Integrator::integrate</a> This is the actual method that should perform the time integration.</li>
</ul>
<ul>
<li><a class="el" href="classrr_1_1_integrator.html#a5469efaa4c234b7e59d82d98930fa5b9">Integrator::restart</a> This method is called whenever the <a class="el" href="classrr_1_1_road_runner.html">RoadRunner</a> object is re-started. This gives the integrator an option to reload any internal solvers. Simple integrators like the <a class="el" href="classrr_1_1_euler_integrator.html">EulerIntegrator</a> does not really do anything in the <a class="el" href="classrr_1_1_euler_integrator.html#a08903e998cf527552442f8fa930772c8">EulerIntegrator::restart</a> method, but more sophisticated ones like the CVODE integrator perform a number of tasks such as re-calclating the tollerances and so forth.</li>
</ul>
<p>The other key thing that an <a class="el" href="classrr_1_1_integrator.html">Integrator</a> needs to do is provide a </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> Dictionary* getIntegratorOptions();</div>
</div><!-- fragment --><p> method, as in the <a class="el" href="classrr_1_1_euler_integrator.html#a601356d923b1dcd513952bdf43ac114d">EulerIntegrator::getIntegratorOptions</a>. This method is used by the <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> to build a list of all the available tuning parameters that any integrator supports. The returned <a class="el" href="classrr_1_1_dictionary.html">Dictionary</a> pointer should be statically created inside the implemtation file, and should contain the following keys / values</p>
<table class="doxtable">
<tr>
<td>Key </td><td>Value </td></tr>
<tr>
<td>integrator </td><td>The name of your new integrator  </td></tr>
<tr>
<td>integrator.description </td><td>A description of your new integrator  </td></tr>
<tr>
<td>integrator.hint </td><td>A short hint for your new integrator  </td></tr>
</table>
<p>Any additional tuning parameters should be listed in this dictionary, where each tuning parameter should have three key/value pairs.</p>
<table class="doxtable">
<tr>
<td>Key </td><td>Value </td></tr>
<tr>
<td>parameterName </td><td>The default value of this tuning parmeter  </td></tr>
<tr>
<td>parameterName.description </td><td>A description of this tuning parameter  </td></tr>
<tr>
<td>integrator.hint </td><td>A short hint for this tuning parameter  </td></tr>
</table>
<p>When the <a class="el" href="classrr_1_1_integrator.html#ac1fa1ad5df380215b40bb1ab268621fa">Integrator::setSimulateOptions</a> method is called, the integrator should read any parameters it expects out of the given dictionary.</p>
<h2><a class="anchor" id="sec_tellrr"></a>
Telling RoadRunner about the new Integrator</h2>
<p>In order for the <a class="el" href="classrr_1_1_road_runner.html#a196e38611d37cd1a79bce8373ceb12da">RoadRunner::simulate</a> method use the new integrator, it needs to know about it. The <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> is the only object that knows about all the integrators, and a few lines of code need to be added in the implementation of this object so that it can construct one.</p>
<p>First, a new enum value needs to be added to the <a class="el" href="classrr_1_1_integrator.html#ae61db0bdde94a0f310e33a93c451720b">Integrator::IntegratorId</a> enum. This is numeric index of the integrator. Then the textual name of the integrator needs to be added to the <code>integratorNames</code> static array in the Integrator.cpp file. Then a line needs to be added inside the <a class="el" href="classrr_1_1_integrator_factory.html#ae43f5cd23488a69528785bf97db603b8">IntegratorFactory::New</a> method which will create the new integrator, e.g. this is a series of <code>if</code> statements, and a new statment needs to be created which creates an instance of the new kind of integrator:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (opt-&gt;integrator == <a class="code" href="classrr_1_1_integrator.html#ae61db0bdde94a0f310e33a93c451720bac2126997f88a748f228b6e70ddcb9a21">Integrator::GILLESPIE</a>)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> GillespieIntegrator(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt-&gt;integrator == <a class="code" href="classrr_1_1_integrator.html#ae61db0bdde94a0f310e33a93c451720babf60b3386c821eb561c04df2f2a357ed">Integrator::RK4</a>)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> RK4Integrator(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt-&gt;integrator == <a class="code" href="classrr_1_1_integrator.html#ae61db0bdde94a0f310e33a93c451720bad13f63587776e3cbf9d2c944514111d3">Integrator::EULER</a>)</div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> EulerIntegrator(m, opt);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    result = <span class="keyword">new</span> CVODEIntegrator(m, opt);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Finally, the <a class="el" href="classrr_1_1_integrator_factory.html#ac82f5094d8f5f37ea00dcbeb98907d87">IntegratorFactory::getIntegratorOptions()</a> method needs to be updated to also return the dictionary that was created in the getIntegratorOptions method, e.g.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> Dictionary* options[] = {</div>
<div class="line">        CVODEIntegrator::getIntegratorOptions(),</div>
<div class="line">        GillespieIntegrator::getIntegratorOptions(),</div>
<div class="line">        <a class="code" href="classrr_1_1_r_k4_integrator.html#a56111c6088ea264cafb987c6668951a7">RK4Integrator::getIntegratorOptions</a>(),</div>
<div class="line">        <a class="code" href="classrr_1_1_euler_integrator.html#a601356d923b1dcd513952bdf43ac114d">EulerIntegrator::getIntegratorOptions</a>()</div>
<div class="line">};</div>
</div><!-- fragment --><p>Once the <a class="el" href="classrr_1_1_integrator_factory.html">IntegratorFactory</a> is made aware of your new integrator, it is available for full introspection and can be used by just adding the <code>integrator="myNewIntegrator"</code> argument whenever the <a class="el" href="classrr_1_1_road_runner.html#a196e38611d37cd1a79bce8373ceb12da">RoadRunner.simulate</a> method is called. The <a class="el" href="classrr_1_1_euler_integrator.html">EulerIntegrator</a> was created as an example of how to create and add a new integrator, have a look at it.</p>
<div class="fragment"></div><!-- fragment --><p> An example of using the <a class="el" href="classrr_1_1_euler_integrator.html">EulerIntegrator</a> and setting a parameter in Python via the keyword arguments to simulate is</p>
<div class="fragment"><div class="line">r.simulate(integrator=<span class="stringliteral">&#39;euler&#39;</span>, exampleParameter1=123456, exampleParameter2=<span class="stringliteral">&#39;some value&#39;</span>);</div>
<div class="line"></div>
<div class="line">print(r.integrator)</div>
<div class="line">&lt; roadrunner.EulerIntegrator() { </div>
<div class="line">  <span class="stringliteral">&#39;this&#39;</span> : 0x101f28350</div>
<div class="line">  <span class="stringliteral">&#39;exampleParameter1&#39;</span> : 123456</div>
<div class="line">  <span class="stringliteral">&#39;exampleParameter2&#39;</span> : some value</div>
<div class="line">}&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 18 2014 10:58:11 for libRoadRunner C++ API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
